---
title: "Eila's Rough Notes"
output: github_document
---

```{r libraries, message = FALSE}
library(tidyverse)
library(readr)
library(dplyr)
library(skimr)
library(here)
```

```{r datasets-and-variables, message = FALSE}
f1merged_hybrid <- read_csv("/cloud/project/data/f1merged_hybrid.csv")

key_teams <- c("Ferrari", 
               "McLaren",
               "Mercedes",
               "Red Bull",
               "Williams")

key_team_colours <- c("Mercedes" = "#00d2be",
                  "Red Bull" = "#0600ef",
                  "Ferrari" = "#dc0000",
                  "McLaren" = "#ff8700",
                  "Williams" = "#0082fa")
```


## Are There Hidden Variables in the Mercedes/Driver Performance Visualisation?

### Are There an Abundance of Mercedes Racers?
First, we want to check if this large number of successful Mercedes drivers is due to a larger number of Mercedes drivers in general.
```{r driver-count}
f1merged_hybrid %>%
  filter(constructorname %in% key_teams) %>%
  group_by(constructorname) %>%
  count(constructorname)
```
This shows us that we are only considering a subset of the data with the exact same numbers of drivers per key constructor. Thus, the high number of wins of Mercedes is not due to an abundance of racers using Mercedes.

### Do Faster Cars Have More Wins, Not Just Mercedes?
What if Mercedes engines just make for a faster car than the others? (i.e. having a Mercedes doesn't help you win, having a fast car does). We can check this by seeing if Mercedes have a higher average speed compared to the other key constructors.

Notes:  
* We are including drivers who haven't won (but excluding those that don't finish) in this analysis since we just want to investigate the driver's speeds. 
* We also keep in mind that F1 tracks are always between 305-310 km, and the 5km difference does nothing significant to the different lap times.
* We round avg_lap_time_min to 5dp since the most accurate time measurement we have is milliseconds.

```{r constructor-speeds}
f1merged_hybrid %>%
  filter(constructorname %in% key_teams) %>%
  drop_na() %>%
  summarise(constructorname,
            "avg_lap_time_min" = ((milliseconds/laps)/60000) %>% round(5)) %>%
  group_by(constructorname) %>%
  ggplot(aes(x = avg_lap_time_min, y = constructorname, 
             fill = constructorname)) +
  geom_boxplot(alpha = 0.7, width = 0.5) +
  scale_x_reverse() +
  coord_cartesian(xlim = c(2.5,1)) +
  scale_fill_manual(values = key_team_colours) +
  theme(legend.position = "none") +
  labs(title = "Average Lap Time of Formula 1 Racers",
       x = "Lap Time (Minutes)",
       y = "Constructor")

  
  
            
```
Mercedes drivers have a lower median lap time. This suggests that Mercedes drivers have a higher average speed than other constructors, and thus could be the reason for their large amount of wins. However, this would suggest that Ferrari and Red Bull would also have a large amount of wins since they have a similar median lap time, however our visualisation earlier (Race Wins by Constructor) shows that Ferrari and Red Bull are nowhere near Mercedes. Thus, it is unlikely that the average lap time significantly boosts your chances of winning.

