---
title: "Project proposal"
author: "ECK"
output: github_document
---

```{r load-packages, message = FALSE, echo = FALSE}
library(tidyverse)
library(broom)
library(here)
library(skimr)
```

## 1. Introduction
We will be looking at the question **"What makes a successful Formula One team?"**. In particular, we will look at Mercedes-AMG Petronas F1 Team, and their success in the hybrid era (2014-2020*). 

The data we are using comes from the Ergast Developer API (**http://ergast.com/mrd/**). It provides data for the Formula One (F1) racing series from 1950 to present. The data is collected from official race classifications released by the FIA, Formula One's governing body.

Much of our analysis will focus on the *f1merged* dataframe, which combines relevant data from the results, races, drivers & constructors data frames. Each observation in this dataframe represents the result of one driver at one race. 

Variables in this data frame include: 

+ Unique ID numbers and identifiers for each result, race, driver and constructor. 
+ The year/season, round number, date and name of each race.
+ Driver names and numbers. Constructor names and nationalities.
+ Starting and finishing positions for each driver.
+ Laps completed, points gained, finishing time.
+ Fastest lap time, fastest lap speed and fastest lap ranking.
+ Status ID, which links to a data frame with detailed finishing statuses.

We will also look at the *qualifying* data frame, with variables for race, driver, constructor and qualifying position, as well as fastest lap times from each qualifying session.
 
Similarly we will use the *pit_stops* data frame, with variables for race, driver, stop number, lap number, time of the pit stop and duration of the pit stop.
 
\**The 2021 season is excluded from our analysis because it is still ongoing at the time of writing*.

## 2. Data

For this project, we will be using a combination of data frames from the Formula One data set. The combined data frame *f1merged* will give us the variables referenced above in the **Introduction** section.

Here is a glimpse and skim of the *f1merged* data frame.
```{r echo = FALSE}
f1merged <- read_csv("/cloud/project/data/f1merged.csv")
f1merged_hybrid <- read_csv("/cloud/project/data/f1merged_hybrid.csv")
glimpse(f1merged)
skim(f1merged)
```

It's perhaps worth noting that the large number of NA values in this data frame do not signify errors in the data.

An NA value in the *position* column represents a driver that did not finish that race, and data on individual lap times and speeds was not available for much of F1's history.


## 3. Data analysis plan

The plan for this data analysis is to explore the question   
**"What makes a successful Formula One (F1) team?"**

There's no questioning Mercedes-AMG Petronas F1 Team as the most successful constructor of the hybrid era.

They have won the World Constructor's and Driver's Championships seven years running.

They boast an overwhelming majority of all race wins: 
```{r mercedes_accolades_wins, echo = FALSE}
team_colours <- c("Mercedes" = "#00d2be",
                  "Red Bull" = "#0600ef",
                  "Ferrari" = "#dc0000",
                  "Racing Point" = "#F596C8",
                  "Force India" = "#f596c8",
                  "AlphaTauri" = "#ffffff",
                  "McLaren" = "#ff8700",
                  "Renault" = "#fff500",
                  "Williams" = "#0082fa",
                  "Toro Rosso" = "#469BFF",
                  "Lotus F1" = "#000000",
                  "Alfa Romeo" = "#960000",
                  "Sauber" = "#960000",
                  "Haas F1 Team" = "#787878")

f1merged_hybrid %>%
  filter(positionText == 1) %>%
count(constructorname, sort = TRUE) %>% 
  ggplot(aes(x = n, 
             y = factor(constructorname, levels = rev(levels(factor(constructorname)))),
             fill = constructorname)) +
  geom_col(aes()) + 
 scale_fill_manual(values = team_colours) +
  labs(title = "Race Wins by Constructor",
       subtitle = "In the hybrid era (2014-2020)",
       x = "Race Wins",
      y = "Constructor") +
  guides(fill = "none")
```

and pole positions (1st place in the Saturday qualifying session):

```{r mercedes_accolades_poles, echo = FALSE}
f1merged_hybrid %>%
  filter(grid == 1) %>%
count(constructorname, sort = TRUE) %>% 
  ggplot(aes(x = n, 
             y = factor(constructorname, levels = rev(levels(factor(constructorname)))),
             fill = constructorname)) +
  geom_col(aes()) + 
 scale_fill_manual(values = team_colours) +
  labs(title = "Pole Positions by Constructor",
       subtitle = "In the hybrid era (2014-2020)",
       x = "Pole Positions",
      y = "Constructor") + 
  guides(fill = "none")
```

We want to look at what goes into this success; Is it sufficient to simply have the fastest car, or do other factors like pit stop times and reliability also correlate with race wins and podiums?

How important is qualifying position as far as race results are concerned?

How does the number of retirements per season correlate with points won?
